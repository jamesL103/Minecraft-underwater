id: ARCH_CARVING
type: BIOME
abstract: true

features:
  preprocessors:
    - FILL_CAVES

carving:
  sampler:
    dimensions: 3
    type: EXPRESSION
    variables:

      carvingThreshold: 0.55
      carvingMinHeight: 50
      minHeightVariation: 4
      carvingMaxHeight: 62
      carvingCap: 1

      spaghettiStrengthLarge: 0.59
      spaghettiStrengthSmall: 0.57

    expression: # using arches sampler defined in pack.yml
      -carvingThreshold
      + if(y<(carvingMinHeight + (minHeightVariation * ((minHeightOffset(x,z)/4) - 0.75)))||y>carvingMaxHeight, 0,
        min(carvingCap,
          max(
            spaghettiStrengthLarge * ((-(|arches(x,y+0000,z)|+|arches(x,y+1000,z)|)/2)+1),
            spaghettiStrengthSmall * ((-(|arches(x,y+2000,z)|+|arches(x,y+3000,z)|)/2)+1)
          )
        )
      )

    samplers:
      minHeightOffset:
        dimensions: 2
        type: FBM
        octaves: 3
        sampler:
          type: OPEN_SIMPLEX_2
          frequency: 0.1


